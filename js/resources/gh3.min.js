(function(){var k=this,a,j,m,d,l,h,f,b,c,g;if(typeof exports!=="undefined"){a=exports}else{a=k.Gh3={}}a.VERSION="0.0.7";j=function(){};j.inherits=function(n,e,p){var r,o=function(){},q=function(s,t){for(var u in t){s[u]=t[u]}};if(e&&e.hasOwnProperty("constructor")){r=e.constructor}else{r=function(){n.apply(this,arguments)}}q(r,n);o.prototype=n.prototype;r.prototype=new o();if(e){q(r.prototype,e)}if(p){q(r,p)}r.prototype.constructor=r;r.__super__=n.prototype;return r};j.extend=function(e,n){var o=j.inherits(this,e,n);o.extend=this.extend;return o};if(!k.Base64){g={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decode:function(o){var e="";var v,t,r;var u,s,q,p;var n=0;o=o.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(n<o.length){u=this._keyStr.indexOf(o.charAt(n++));s=this._keyStr.indexOf(o.charAt(n++));q=this._keyStr.indexOf(o.charAt(n++));p=this._keyStr.indexOf(o.charAt(n++));v=(u<<2)|(s>>4);t=((s&15)<<4)|(q>>2);r=((q&3)<<6)|p;e=e+String.fromCharCode(v);if(q!=64){e=e+String.fromCharCode(t)}if(p!=64){e=e+String.fromCharCode(r)}}e=g._utf8_decode(e);return e},encode:function(o){var e="";var v,t,r,u,s,q,p;var n=0;o=g._utf8_encode(o);while(n<o.length){v=o.charCodeAt(n++);t=o.charCodeAt(n++);r=o.charCodeAt(n++);u=v>>2;s=((v&3)<<4)|(t>>4);q=((t&15)<<2)|(r>>6);p=r&63;if(isNaN(t)){q=p=64}else{if(isNaN(r)){p=64}}e=e+this._keyStr.charAt(u)+this._keyStr.charAt(s)+this._keyStr.charAt(q)+this._keyStr.charAt(p)}return e},_utf8_decode:function(e){var n="";var o=0;var p=c1=c2=0;while(o<e.length){p=e.charCodeAt(o);if(p<128){n+=String.fromCharCode(p);o++}else{if((p>191)&&(p<224)){c2=e.charCodeAt(o+1);n+=String.fromCharCode(((p&31)<<6)|(c2&63));o+=2}else{c2=e.charCodeAt(o+1);c3=e.charCodeAt(o+2);n+=String.fromCharCode(((p&15)<<12)|((c2&63)<<6)|(c3&63));o+=3}}}return n},_utf8_encode:function(o){o=o.replace(/\r\n/g,"\n");var e="";for(var q=0;q<o.length;q++){var p=o.charCodeAt(q);if(p<128){e+=String.fromCharCode(p)}else{if((p>127)&&(p<2048)){e+=String.fromCharCode((p>>6)|192);e+=String.fromCharCode((p&63)|128)}else{e+=String.fromCharCode((p>>12)|224);e+=String.fromCharCode(((p>>6)&63)|128);e+=String.fromCharCode((p&63)|128)}}}return e}};k.Base64=g}a.Base64=k.Base64;if(window.XDomainRequest){try{new XDomainRequest();$.support.cors=true;$.ajaxSetup.xhr=function(){return new XDomainRequest()}}catch(i){}}a.Helper=j.extend({},{protocol:"https",domain:"api.github.com",headers:{Origin:location.host,Accept:"application/vnd.github+json","Content-Type":"application/json"},dataType:"json",cache:true,callHttpApi:function(e){e.url=a.Helper.protocol+"://"+a.Helper.domain+"/"+e.service;if($.support.cors){e.headers=$.extend({},a.Helper.headers,e.headers||{});if(!e.dataType){e.dataType=a.Helper.dataType}if(!e.cache&&e.cache!==false){e.cache=a.Helper.cache}var n=e.success;if($.isFunction(n)){e.success=function(p,q,o){n.call(this,{data:p},q,o)}}}else{e.dataType="jsonp"}$.ajax(e)}});m=j.extend({_call:function(o,e){var n=$.extend({},e||{},{type:o,service:this._service()});a.Helper.callHttpApi(n)},check:function(n,e){this._call("GET",{success:function(){n(true)},error:function(o){if(o.status==404){n(false)}else{e(o)}}})},set:function(n,e){this._call("PUT",{success:n,error:e})},unset:function(n,e){this._call("DELETE",{success:n,error:e})}});a.Star=m.extend({constructor:function(e){this.repository=e},_service:function(){return"user/starred/"+this.repository.path()}});a.Watching=m.extend({constructor:function(e){this.repository=e},_service:function(){return"user/subscriptions/"+this.repository.path()}});a.Following=m.extend({constructor:function(e){this.user=e},_service:function(){return"user/following/"+this.user.login}});f=j.extend({constructor:function(){this.fetched=false},_setData:function(e){if(!e){return}for(var n in e){this[n]=e[n]}},_onFetchSuccess:function(n,e){this.fetched=true;if(n){n(null,this)}},_onFetchError:function(n,e){if(n){n(e)}},_service:function(){throw ("Undefined service")},_defaultFetchCallParams:function(){return{}},_preFetch:function(n,e){},fetch:function(r,n){var o=this,e,q,p;o._preFetch(r,n);q={service:o._service(),success:function(s){o._onFetchSuccess(r,s)},error:function(s){o._onFetchError(r,s)}};e=o._defaultFetchCallParams();if(n){e.data=$.extend({},e.data||{},n)}a.Helper.callHttpApi($.extend({},e,q))}});h=f.extend({constructor:function(e){h.__super__.constructor.call(this);this._setData(e)},_onFetchSuccess:function(n,e){this._setData(e.data);h.__super__._onFetchSuccess.call(this,n,e)}});d={};d._Base=f.extend({constructor:function(e){this.parent=e;this.list=[];d._Base.__super__.constructor.call(this)},length:function(){return this.list.length},reverse:function(){this.list.reverse()},sort:function(e){if(e){this.list.sort(e)}else{this.list.sort()}},getAll:function(){return this.list},filterBy:function(n,e){return _.filter(this.list,function(o){return o[n]==e},this)},getBy:function(n,e){return _.find(this.list,function(o){return o[n]==e},this)},getByName:function(e){return this.getBy("name",e)},each:function(e){_.each(this.list,e)},_onFetchSuccess:function(n,e){this.fetched=true;this._setItems(e.data);if(n){n(null,this.parent)}},_prepareItem:function(e){return e},_addItem:function(e){this.list.push(this._prepareItem(e))},_addItems:function(e){var n=this;_.each(e,function(o){n._addItem(o)})},_setItems:function(e){this.list=[];this._addItems(e)}});a.User=h.extend({constructor:function(e,n){if(e){this.login=e}else{throw"login !"}a.User.__super__.constructor.call(this,n);this.repositories=new d.UserRepositories(this);this.members=new d.OrganizationMembers(this);this.orgs=new d.UserOrganizations(this);this.followers=new d.UserFollowers(this);this.following=new d.UserFollowing(this);this.starred=new d.UserStarredRepositories(this);this.events=new d.UserEvents(this);this.received_events=new d.UserReceivedEvents(this);this.gists=new d.UserGists(this)},_service:function(){return"users/"+this.login},_setData:function(e){if(e){if(typeof e.followers!=="undefined"){e.followers_count=e.followers;delete e.followers}if(typeof e.following!=="undefined"){e.following_count=e.following;delete e.following}}a.User.__super__._setData.call(this,e)}});d._UsersList=d._Base.extend({_prepareItem:function(e){return new a.User(e.login,e)},getByLogin:function(e){return this.getBy("login",e)}});d.OrganizationMembers=d._UsersList.extend({_service:function(){return"orgs/"+this.parent.login+"/members"}});d.UserOrganizations=d._UsersList.extend({_service:function(){return this.parent._service()+"/orgs"}});d.UserFollowers=d._UsersList.extend({_service:function(){return this.parent._service()+"/followers"}});d.UserFollowing=d._UsersList.extend({_service:function(){return this.parent._service()+"/following"}});d.RepositoryContributors=d._UsersList.extend({_service:function(){return this.parent._service()+"/contributors"}});d.RepositoryStargazers=d._UsersList.extend({_service:function(){return this.parent._service()+"/stargazers"}});a.CurrentUser=a.User.extend({constructor:function(){a.CurrentUser.__super__.constructor.call(this,"logged-user")},_service:function(){return"user"}});a.Event=h.extend({_setData:function(e){if(e){if(e.actor){if(e.actor.id&&e.actor.login){if(!this.actor){this.actor=new a.User(e.actor.login)}this.actor._setData(e.actor)}delete e.actor}if(e.repo){if(e.repo.id&&e.repo.name){if(!this.repository){var n=e.repo.name.split("/");this.repository=new a.Repository(n[1],new a.User(n[0]))}this.repository._setData(e.repo)}delete e.repo}}a.Event.__super__._setData.call(this,e)}});d._EventsList=d._Base.extend({_prepareItem:function(e){return new a.Event(e)}});d.UserEvents=d._EventsList.extend({_service:function(){return this.parent._service()+"/events"}});d.UserReceivedEvents=d._EventsList.extend({_service:function(){return this.parent._service()+"/received_events"}});d.RepositoryEvents=d._EventsList.extend({_service:function(){return this.parent._service()+"/events"}});a.Gist=h.extend({constructor:function(p,o,n,e){this.user=o||null;this.parent=n||null;this.version=e||null;this.files=new d.GistFiles(this);this.comments=new d.GistComments(this);this.forks=new d.GistForks(this);this.history=new d.GistHistory(this);a.Gist.__super__.constructor.call(this,p)},_setData:function(e){if(e.user){if(!this.user){this.user=new a.User(e.user.login)}this.user._setData(e.user);delete e.user}if(e.files){this.files._setItems(e.files);delete e.files}if(e.fork_of){if(!this.parent){this.parent=new a.Gist({id:e.fork_of.id},new a.User(e.fork_of.user.login,e.fork_of.user))}this.parent._setData(e.fork_of);delete e.fork_of}if(e.forks){this.history._setItems(e.forks);delete e.forks}if(e.history){this.history._setItems(e.history);delete e.history}e.comment_count=e.comments;delete e.comments;a.Gist.__super__._setData.call(this,e)},_baseService:function(){return"gists/"+this.id},_service:function(){var e=this._baseService();if(this.version){e+="/"+this.version}return e}});a.GistComment=h.extend({constructor:function(n,e){this.gist=e;a.GistComment.__super__.constructor.call(this,n)},_service:function(){return this.gist._baseService()+"/comments/"+this.id},_setData:function(e){if(e.user){if(!this.user){this.user=new a.User(e.user.login)}this.user._setData(e.user);delete e.user}a.GistComment.__super__._setData.call(this,e)}});d.GistComments=d._Base.extend({_prepareItem:function(e){return new a.GistComment(e,this.parent)},_service:function(){return this.parent._baseService()+"/comments"}});d.GistForks=d._Base.extend({_prepareItem:function(n){var e;if(n.user){e=new a.User(n.user.login,n.user)}return new a.Gist(n,e,this.parent)},_service:function(){return this.parent._baseService()+"/forks"}});d.UserGists=d._Base.extend({_prepareItem:function(e){return new a.Gist(e,this.parent)},_service:function(){return this.parent._service()+"/gists"}});a.GistFile=h.extend({constructor:function(e,n){this.gist=n;a.GistFile.__super__.constructor.call(this,e)}});d.GistFiles=d._Base.extend({_prepareItem:function(e){return new a.GistFile(e,this.parent)},getByName:function(e){return this.getBy("filename",e)}});a.GistVersion=h.extend({constructor:function(e,o,n){this.parent=n;this.version=e;this.gist=new a.Gist({id:this.parent.id},this.parent.user,null,this.version);a.GistVersion.__super__.constructor.call(this,o)}});d.GistHistory=d._Base.extend({_prepareItem:function(e){return new a.GistVersion(e.version,e,this.parent)}});l=h.extend({constructor:function(e,n){this.branch=n;l.__super__.constructor.call(this,e)},_service:function(){return this.branch.repository._service()+"/contents/"+this.path}});a.File=l.extend({constructor:function(e,n){a.File.__super__.constructor.call(this,e,n);this.commits=new d.FileCommits(this)},_service:function(){return this.branch.repository._service()+"/contents/"+this.path},_defaultFetchCallParams:function(){var e=d.ItemContents.__super__._defaultFetchCallParams.call(this);e.data=$.extend({},e.data||{},{ref:this.branch.name});return e},_onFetchSuccess:function(n,e){if(e.data.content){e.data.content=g.decode(e.data.content)}a.File.__super__._onFetchSuccess.call(this,n,e)}});a.Dir=l.extend({constructor:function(e,n){a.Dir.__super__.constructor.call(this,e,n);this.contents=new d.ItemContents(this)}});d.ItemContents=d._Base.extend({_prepareItem:function(e){return new a[e.type=="file"?"File":"Dir"](e,this.parent)},_service:function(){return this.parent.branch.repository._service()+"/contents/"+this.parent.path},_defaultFetchCallParams:function(){var e=d.ItemContents.__super__._defaultFetchCallParams.call(this);e.data=$.extend({},e.data||{},{ref:this.parent.branch.name});return e},files:function(e){return _.filter(this.list,function(n){return n.type=="file"},this)},dirs:function(e){return _.filter(this.list,function(n){return n.type=="dir"},this)},getFileByName:function(e){return _.find(this.list,function(n){return n.name==e&&n.type=="file"})},getDirByName:function(e){return _.find(this.list,function(n){return n.name==e&&n.type=="dir"})}});a.Commit=h.extend({constructor:function(n,e){this.branch=e;this.files=new d.CommitFiles(this);a.Commit.__super__.constructor.call(this,n)},_setData:function(e){if(e.author){if(!this.author){this.author=new a.User(e.author.login)}this.author._setData(e.author);delete e.author}if(e.commiter){if(!this.author||e.commiter.login!=this.author.login){if(!this.commiter){this.commiter=new a.User(e.commiter.login)}this.commiter._setData(e.commiter)}else{this.commiter=this.author}delete e.commiter}if(e.files){this.files._setItems(e.files);delete e.files}a.Commit.__super__._setData.call(this,e)}});a.CommitFile=h.extend({constructor:function(e,n){this.commit=n;a.CommitFile.__super__.constructor.call(this,e)},_setData:function(n){var e={sha:n.sha,filename:n.filename};if(!this.file){this.file=new a.File(e,this.commit.branch)}else{this.file._setData(e)}a.CommitFile.__super__._setData.call(this,n)}});d.CommitFiles=d._Base.extend({_prepareItem:function(e){return new a.CommitFile(e,this.parent)},getByName:function(e){return this.getBy("filename",e)}});d._Commits=d._Base.extend({_service:function(){return this.parent.branch.repository._service()+"/commits"},_prepareItem:function(e){return new a.Commit(e,this.parent.branch)},last:function(){return this.list[0]},first:function(){return this.list[this.list.length-1]}});d.FileCommits=d._Commits.extend({_defaultFetchCallParams:function(o,e){var n=d.FileCommits.__super__._defaultFetchCallParams.call(this,o,e);n.data=$.extend({},n.data||{},{path:this.parent.path});return n}});d.BranchCommits=d._Commits.extend({_defaultFetchCallParams:function(o,e){var n=d.FileCommits._defaultFetchCallParams.call(this,o,e);n.data=$.extend({},n.data||{},{ref:this.parent.name});return n}});a.Branch=h.extend({constructor:function(n,e){this.repository=e;this.branch=this;this.path="";a.Branch.__super__.constructor.call(this,n);this.contents=new d.ItemContents(this)},_service:function(){return this.parent._service()+"/branches/"+this.name},_setData:function(e){if(e.commit){if(!this.head_commit||this.head_commit.sha!=e.commit.sha){this.head_commit=new a.Commit({sha:e.commit.sha},this)}this.head_commit._setData(e.commit);delete e.commit}a.Branch.__super__._setData.call(this,e)}});d.RepositoryBranches=d._Base.extend({_service:function(){return this.parent._service()+"/branches"},_prepareItem:function(e){return new a.Branch(e,this.parent)}});a.Repository=h.extend({constructor:function(e,o,p,n){if(e&&o){this.name=e;this.user=o}else{throw"name && user !"}this.parent=n||null;a.Repository.__super__.constructor.call(this,p);this.readme="";this.readmeFetcher=new b(this);this.contributors=new d.RepositoryContributors(this);this.forks=new d.RepositoryForks(this);this.stargazers=new d.RepositoryStargazers(this);this.events=new d.RepositoryEvents(this);this.branches=new d.RepositoryBranches(this);this.issues=new d.RepositoryIssues(this);this.pull_requests=new d.RepositoryPullRequests(this)},path:function(){return this.user.login+"/"+this.name},_service:function(){return"repos/"+this.path()},fetchReadme:function(n,e){this.readmeFetcher.fetch(n,e)},_setData:function(e){if(e){if(e.owner){this.user._setData(e.owner);delete e.owner}if(e.source){if(!this.source){this.source=new a.Repository(e.source.name,new a.User(e.source.owner.login,e.source.owner))}this.source._setData(e.source);delete e.source}if(e.parent){if(!this.parent){this.parent=new a.Repository(e.parent.name,new a.User(e.parent.owner.login,e.parent.owner))}this.parent._setData(e.parent);delete e.parent}}a.Repository.__super__._setData.call(this,e)}});b=f.extend({constructor:function(e){this.repository=e;b.__super__.constructor.call(this)},_service:function(){return this.repository._service()+"/readme"},_onFetchSuccess:function(n,e){this.repository.readme=e.data;this.fetched=true;if(n){n(null,this.repository)}},_defaultFetchCallParams:function(){var e=b.__super__._defaultFetchCallParams.call(this);e.dataType="html";e.headers=$.extend({},e.headers||{},{Accept:"application/vnd.github.html+json","Content-Type":"text/html"});return e}});d._RepositoriesList=d._Base.extend({_prepareItem:function(n){var e=new a.User(n.owner.login,n.owner);return new a.Repository(n.name,e,n)}});d.UserRepositories=d._RepositoriesList.extend({_service:function(){return this.parent._service()+"/repos"}});d.UserStarredRepositories=d._RepositoriesList.extend({_service:function(){return this.parent._service()+"/starred"}});d.RepositoryForks=d._RepositoriesList.extend({_prepareItem:function(n){var e=new a.User(n.owner.login,n.owner);return new a.Repository(n.name,e,n,this.parent)},_service:function(){return this.parent._service()+"/forks"}});c=h.extend({constructor:function(n,e,o){if(n&&e){this.number=e;this.repository=n}else{throw"number && repository !"}c.__super__.constructor.call(this,o)},_defaultFetchCallParams:function(){var e=c.__super__._defaultFetchCallParams.call(this);e.headers=$.extend({},e.headers||{},{Accept:"application/vnd.github.html+json"});return e},_setData:function(e){if(e){if(e.user){if(e.user.login){if(!this.user){this.user=new a.User(e.user.login)}this.user._setData(e.user)}delete e.user}if(e.assignee){if(e.assignee.login){if(!this.assignee){this.assignee=new a.User(e.assignee.login)}this.assignee._setData(e.assignee)}delete e.assignee}if(e.repo){this.repository._setData(e.repo);delete e.repo}}c.__super__._setData.call(this,e)}});d._BaseIssuesList=d._Base.extend({_prepareItem:function(e){return new this.model(this.parent,e.number,e)},_defaultFetchCallParams:function(){var e=d._BaseIssuesList.__super__._defaultFetchCallParams.call(this);e.headers=$.extend({},e.headers||{},{Accept:"application/vnd.github.html+json"});return e}});a.Issue=c.extend({_service:function(){return this.repository._service()+"/issues/"+this.number}});d._IssuesList=d._BaseIssuesList.extend({model:a.Issue});d.RepositoryIssues=d._IssuesList.extend({_service:function(){return this.parent._service()+"/issues"}});a.PullRequest=c.extend({_service:function(){return this.repository._service()+"/pulls/"+this.number},_setData:function(e){if(e){if(e.merged_by){if(e.merged_by.login){if(!this.merged_by){this.merged_by=new a.User(e.merged_by.login)}this.merged_by._setData(e.merged_by)}delete e.merged_by}}a.PullRequest.__super__._setData.call(this,e)}});d._PullRequestsList=d._BaseIssuesList.extend({model:a.PullRequest});d.RepositoryPullRequests=d._PullRequestsList.extend({_service:function(){return this.parent._service()+"/pulls"}});d.Search=d._Base.extend({constructor:function(e){this.keyword=e||null;d.Search.__super__.constructor.call(this,null)},search:function(n,o,e){this.list=[];this.keyword=n;this.fetch(o,e)}});a.Repository.Search=d.Search.extend({_service:function(){return"legacy/repos/search/"+this.keyword},_prepareItem:function(n){var e=new a.User(n.owner);delete n.owner;delete n.username;return new a.Repository(n.name,e,n)},_onFetchSuccess:function(n,e){this.fetched=true;this._setItems(e.data.repositories);if(n){n(null,this)}}});a.User.Search=d.Search.extend({_service:function(){return"legacy/user/search/"+this.keyword},_prepareItem:function(e){return new a.User(e.login,e)},getByLogin:function(e){return this.getBy("login",e)},_onFetchSuccess:function(n,e){this.fetched=true;this._setItems(e.data.users);if(n){n(null,this)}}})}).call(this);