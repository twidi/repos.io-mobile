(function(){var a=this,b,c,d,e,f,g,h,i;if(typeof exports!=='undefined')b=exports;else b=a.Gh3={};b.VERSION='0.0.7';c=function(){};c.inherits=function(a,b,c){var d,e=function(){},f=function(a,b){for(var c in b)a[c]=b[c];};if(b&&b.hasOwnProperty('constructor'))d=b.constructor;else d=function(){a.apply(this,arguments);};f(d,a);e.prototype=a.prototype;d.prototype=new e();if(b)f(d.prototype,b);if(c)f(d,c);d.prototype.constructor=d;d.__super__=a.prototype;return d;};c.extend=function(a,b){var d=c.inherits(this,a,b);d.extend=this.extend;return d;};if(!a.Base64){i={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decode:function(a){var b="";var c,d,e;var f,g,h,j;var k=0;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(k<a.length){f=this._keyStr.indexOf(a.charAt(k++));g=this._keyStr.indexOf(a.charAt(k++));h=this._keyStr.indexOf(a.charAt(k++));j=this._keyStr.indexOf(a.charAt(k++));c=(f<<2)|(g>>4);d=((g&15)<<4)|(h>>2);e=((h&3)<<6)|j;b=b+String.fromCharCode(c);if(h!=64)b=b+String.fromCharCode(d);if(j!=64)b=b+String.fromCharCode(e);}b=i._utf8_decode(b);return b;},encode:function(a){var b="";var c,d,e,f,g,h,j;var k=0;a=i._utf8_encode(a);while(k<a.length){c=a.charCodeAt(k++);d=a.charCodeAt(k++);e=a.charCodeAt(k++);f=c>>2;g=((c&3)<<4)|(d>>4);h=((d&15)<<2)|(e>>6);j=e&63;if(isNaN(d))h=j=64;else if(isNaN(e))j=64;b=b+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h)+this._keyStr.charAt(j);}return b;},_utf8_decode:function(a){var b="";var c=0;var d=c1=c2=0;while(c<a.length){d=a.charCodeAt(c);if(d<128){b+=String.fromCharCode(d);c++;}else if((d>191)&&(d<224)){c2=a.charCodeAt(c+1);b+=String.fromCharCode(((d&31)<<6)|(c2&63));c+=2;}else{c2=a.charCodeAt(c+1);c3=a.charCodeAt(c+2);b+=String.fromCharCode(((d&15)<<12)|((c2&63)<<6)|(c3&63));c+=3;}}return b;},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");var b="";for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);if(d<128)b+=String.fromCharCode(d);else if((d>127)&&(d<2048)){b+=String.fromCharCode((d>>6)|192);b+=String.fromCharCode((d&63)|128);}else{b+=String.fromCharCode((d>>12)|224);b+=String.fromCharCode(((d>>6)&63)|128);b+=String.fromCharCode((d&63)|128);}}return b;}};a.Base64=i;}b.Base64=a.Base64;if(window.XDomainRequest)try{new XDomainRequest();$.support.cors=true;$.ajaxSetup.xhr=function(){return new XDomainRequest();};}catch(j){}b.Helper=c.extend({},{protocol:"https",domain:"api.github.com",headers:{Origin:location.host,Accept:'application/vnd.github+json','Content-Type':'application/json'},dataType:'json',cache:true,callHttpApi:function(a){a.url=b.Helper.protocol+"://"+b.Helper.domain+"/"+a.service;if($.support.cors){a.headers=$.extend({},b.Helper.headers,a.headers||{});if(!a.dataType)a.dataType=b.Helper.dataType;if(!a.cache&&a.cache!==false)a.cache=b.Helper.cache;var c=a.success;if($.isFunction(c))a.success=function(a,b,d){c.call(this,{data:a},b,d);};}else a.dataType='jsonp';$.ajax(a);}});g=c.extend({constructor:function(){this.fetched=false;},_setData:function(a){for(var b in a)this[b]=a[b];},_onFetchSuccess:function(a,b){this.fetched=true;if(a)a(null,this);},_onFetchError:function(a,b){if(a)a(b);},_service:function(){throw 'Undefined service';},_defaultFetchCallParams:function(){return{};},_preFetch:function(a,b){},fetch:function(a,c){var d=this,e,f,g;d._preFetch(a,c);f={service:d._service(),success:function(b){d._onFetchSuccess(a,b);},error:function(b){d._onFetchError(a,b);}};e=d._defaultFetchCallParams();if(c)e.data=$.extend({},e.data||{},c);b.Helper.callHttpApi($.extend({},e,f));}});f=g.extend({constructor:function(a){f.__super__.constructor.call(this);this._setData(a);},_onFetchSuccess:function(a,b){this._setData(b.data);f.__super__._onFetchSuccess.call(this,a,b);}});d={};d._Base=g.extend({constructor:function(a){this.parent=a;this.list=[];d._Base.__super__.constructor.call(this);},length:function(){return this.list.length;},reverse:function(){this.list.reverse();},sort:function(a){if(a)this.list.sort(a);else this.list.sort();},getAll:function(){return this.list;},filterBy:function(a,b){return _.filter(this.list,function(c){return c[a]==b;},this);},getBy:function(a,b){return _.find(this.list,function(c){return c[a]==b;},this);},getByName:function(a){return this.getBy('name',a);},each:function(a){_.each(this.list,a);},_onFetchSuccess:function(a,b){this.fetched=true;this._setItems(b.data);if(a)a(null,this.parent);},_prepareItem:function(a){return a;},_addItem:function(a){this.list.push(this._prepareItem(a));},_addItems:function(a){var b=this;_.each(a,function(a){b._addItem(a);});},_setItems:function(a){this.list=[];this._addItems(a);}});b.User=f.extend({constructor:function(a,c){if(a)this.login=a;else throw "login !";b.User.__super__.constructor.call(this,c);this.repositories=new d.UserRepositories(this);this.members=new d.OrganizationMembers(this);this.orgs=new d.UserOrganizations(this);this.followers=new d.UserFollowers(this);this.following=new d.UserFollowing(this);this.starred=new d.UserStarredRepositories(this);this.events=new d.UserEvents(this);this.received_events=new d.UserReceivedEvents(this);this.gists=new d.UserGists(this);},_service:function(){return "users/"+this.login;},_setData:function(a){if(a){if(typeof a.followers!=='undefined'){a.followers_count=a.followers;delete a.followers;}if(typeof a.following!=='undefined'){a.following_count=a.following;delete a.following;}}b.User.__super__._setData.call(this,a);}});d._UsersList=d._Base.extend({_prepareItem:function(a){return new b.User(a.login,a);},getByLogin:function(a){return this.getBy('login',a);}});d.OrganizationMembers=d._UsersList.extend({_service:function(){return "orgs/"+this.parent.login+"/members";}});d.UserOrganizations=d._UsersList.extend({_service:function(){return this.parent._service()+"/orgs";}});d.UserFollowers=d._UsersList.extend({_service:function(){return this.parent._service()+"/followers";}});d.UserFollowing=d._UsersList.extend({_service:function(){return this.parent._service()+"/following";}});d.RepositoryContributors=d._UsersList.extend({_service:function(){return this.parent._service()+"/contributors";}});d.RepositoryStargazers=d._UsersList.extend({_service:function(){return this.parent._service()+"/stargazers";}});b.Event=f.extend({_setData:function(a){if(a){if(a.actor){if(a.actor.id&&a.actor.login){if(!this.actor)this.actor=new b.User(a.actor.login);this.actor._setData(a.actor);}delete a.actor;}if(a.repo){if(a.repo.id&&a.repo.name){if(!this.repository){var c=a.repo.name.split('/');this.repository=new b.Repository(c[1],new b.User(c[0]));}this.repository._setData(a.repo);}delete a.repo;}}b.Event.__super__._setData.call(this,a);}});d._EventsList=d._Base.extend({_prepareItem:function(a){return new b.Event(a);}});d.UserEvents=d._EventsList.extend({_service:function(){return this.parent._service()+"/events";}});d.UserReceivedEvents=d._EventsList.extend({_service:function(){return this.parent._service()+"/received_events";}});d.RepositoryEvents=d._EventsList.extend({_service:function(){return this.parent._service()+"/events";}});b.Gist=f.extend({constructor:function(a,c,e,f){this.user=c||null;this.parent=e||null;this.version=f||null;this.files=new d.GistFiles(this);this.comments=new d.GistComments(this);this.forks=new d.GistForks(this);this.history=new d.GistHistory(this);b.Gist.__super__.constructor.call(this,a);},_setData:function(a){if(a.user){if(!this.user)this.user=new b.User(a.user.login);this.user._setData(a.user);delete a.user;}if(a.files){this.files._setItems(a.files);delete a.files;}if(a.fork_of){if(!this.parent)this.parent=new b.Gist({id:a.fork_of.id},new b.User(a.fork_of.user.login,a.fork_of.user));this.parent._setData(a.fork_of);delete a.fork_of;}if(a.forks){this.history._setItems(a.forks);delete a.forks;}if(a.history){this.history._setItems(a.history);delete a.history;}a.comment_count=a.comments;delete a.comments;b.Gist.__super__._setData.call(this,a);},_baseService:function(){return "gists/"+this.id;},_service:function(){var a=this._baseService();if(this.version)a+="/"+this.version;return a;}});b.GistComment=f.extend({constructor:function(a,c){this.gist=c;b.GistComment.__super__.constructor.call(this,a);},_service:function(){return this.gist._baseService()+"/comments/"+this.id;},_setData:function(a){if(a.user){if(!this.user)this.user=new b.User(a.user.login);this.user._setData(a.user);delete a.user;}b.GistComment.__super__._setData.call(this,a);}});d.GistComments=d._Base.extend({_prepareItem:function(a){return new b.GistComment(a,this.parent);},_service:function(){return this.parent._baseService()+"/comments";}});d.GistForks=d._Base.extend({_prepareItem:function(a){var c;if(a.user)c=new b.User(a.user.login,a.user);return new b.Gist(a,c,this.parent);},_service:function(){return this.parent._baseService()+"/forks";}});d.UserGists=d._Base.extend({_prepareItem:function(a){return new b.Gist(a,this.parent);},_service:function(){return this.parent._service()+"/gists";}});b.GistFile=f.extend({constructor:function(a,c){this.gist=c;b.GistFile.__super__.constructor.call(this,a);}});d.GistFiles=d._Base.extend({_prepareItem:function(a){return new b.GistFile(a,this.parent);},getByName:function(a){return this.getBy('filename',a);}});b.GistVersion=f.extend({constructor:function(a,c,d){this.parent=d;this.version=a;this.gist=new b.Gist({id:this.parent.id},this.parent.user,null,this.version);b.GistVersion.__super__.constructor.call(this,c);}});d.GistHistory=d._Base.extend({_prepareItem:function(a){return new b.GistVersion(a.version,a,this.parent);}});e=f.extend({constructor:function(a,b){this.branch=b;e.__super__.constructor.call(this,a);},_service:function(){return this.branch.repository._service()+"/contents/"+this.path;}});b.File=e.extend({constructor:function(a,c){b.File.__super__.constructor.call(this,a,c);this.commits=new d.FileCommits(this);},_service:function(){return this.branch.repository._service()+"/contents/"+this.path;},_defaultFetchCallParams:function(){var a=d.ItemContents.__super__._defaultFetchCallParams.call(this);a.data=$.extend({},a.data||{},{ref:this.branch.name});return a;},_onFetchSuccess:function(a,c){if(c.data.content)c.data.content=i.decode(c.data.content);b.File.__super__._onFetchSuccess.call(this,a,c);}});b.Dir=e.extend({constructor:function(a,c){b.Dir.__super__.constructor.call(this,a,c);this.contents=new d.ItemContents(this);}});d.ItemContents=d._Base.extend({_prepareItem:function(a){return new b[a.type=="file"?'File':'Dir'](a,this.parent);},_service:function(){return this.parent.branch.repository._service()+"/contents/"+this.parent.path;},_defaultFetchCallParams:function(){var a=d.ItemContents.__super__._defaultFetchCallParams.call(this);a.data=$.extend({},a.data||{},{ref:this.parent.branch.name});return a;},files:function(a){return _.filter(this.list,function(a){return a.type=="file";},this);},dirs:function(a){return _.filter(this.list,function(a){return a.type=="dir";},this);},getFileByName:function(a){return _.find(this.list,function(b){return b.name==a&&b.type=="file";});},getDirByName:function(a){return _.find(this.list,function(b){return b.name==a&&b.type=="dir";});}});b.Commit=f.extend({constructor:function(a,c){this.branch=c;this.files=new d.CommitFiles(this);b.Commit.__super__.constructor.call(this,a);},_setData:function(a){if(a.author){if(!this.author)this.author=new b.User(a.author.login);this.author._setData(a.author);delete a.author;}if(a.commiter){if(!this.author||a.commiter.login!=this.author.login){if(!this.commiter)this.commiter=new b.User(a.commiter.login);this.commiter._setData(a.commiter);}else this.commiter=this.author;delete a.commiter;}if(a.files){this.files._setItems(a.files);delete a.files;}b.Commit.__super__._setData.call(this,a);}});b.CommitFile=f.extend({constructor:function(a,c){this.commit=c;b.CommitFile.__super__.constructor.call(this,a);},_setData:function(a){var c={sha:a.sha,filename:a.filename};if(!this.file)this.file=new b.File(c,this.commit.branch);else this.file._setData(c);b.CommitFile.__super__._setData.call(this,a);}});d.CommitFiles=d._Base.extend({_prepareItem:function(a){return new b.CommitFile(a,this.parent);},getByName:function(a){return this.getBy('filename',a);}});d._Commits=d._Base.extend({_service:function(){return this.parent.branch.repository._service()+"/commits";},_prepareItem:function(a){return new b.Commit(a,this.parent.branch);},last:function(){return this.list[0];},first:function(){return this.list[this.list.length-1];}});d.FileCommits=d._Commits.extend({_defaultFetchCallParams:function(a,b){var c=d.FileCommits.__super__._defaultFetchCallParams.call(this,a,b);c.data=$.extend({},c.data||{},{path:this.parent.path});return c;}});d.BranchCommits=d._Commits.extend({_defaultFetchCallParams:function(a,b){var c=d.FileCommits._defaultFetchCallParams.call(this,a,b);c.data=$.extend({},c.data||{},{ref:this.parent.name});return c;}});b.Branch=f.extend({constructor:function(a,c){this.repository=c;this.branch=this;this.path='';b.Branch.__super__.constructor.call(this,a);this.contents=new d.ItemContents(this);},_service:function(){return this.parent._service()+"/branches/"+this.name;},_setData:function(a){if(a.commit){if(!this.head_commit||this.head_commit.sha!=a.commit.sha)this.head_commit=new b.Commit({sha:a.commit.sha},this);this.head_commit._setData(a.commit);delete a.commit;}b.Branch.__super__._setData.call(this,a);}});d.RepositoryBranches=d._Base.extend({_service:function(){return this.parent._service()+"/branches";},_prepareItem:function(a){return new b.Branch(a,this.parent);}});b.Repository=f.extend({constructor:function(a,c,e,f){if(a&&c){this.name=a;this.user=c;}else throw "name && user !";this.parent=f||null;b.Repository.__super__.constructor.call(this,e);this.readme='';this.readmeFetcher=new h(this);this.contributors=new d.RepositoryContributors(this);this.forks=new d.RepositoryForks(this);this.stargazers=new d.RepositoryStargazers(this);this.events=new d.RepositoryEvents(this);this.branches=new d.RepositoryBranches(this);},_service:function(){return "repos/"+this.user.login+"/"+this.name;},fetchReadme:function(a,b){this.readmeFetcher.fetch(a,b);},_setData:function(a){if(a){if(a.owner){this.user._setData(a.owner);delete a.owner;}if(a.source){if(!this.source)this.source=new b.Repository(a.source.name,new b.User(a.source.owner.login,a.source.owner));this.source._setData(a.source);delete a.source;}if(a.parent){if(!this.parent)this.parent=new b.Repository(a.parent.name,new b.User(a.parent.owner.login,a.parent.owner));this.parent._setData(a.parent);delete a.parent;}}b.Repository.__super__._setData.call(this,a);}});h=g.extend({constructor:function(a){this.repository=a;h.__super__.constructor.call(this);},_service:function(){return this.repository._service()+"/readme";},_onFetchSuccess:function(a,b){this.repository.readme=b.data;this.fetched=true;if(a)a(null,this.repository);},_defaultFetchCallParams:function(){var a=h.__super__._defaultFetchCallParams.call(this);a.dataType='html';a.headers=$.extend({},a.headers||{},{Accept:'application/vnd.github.html+json','Content-Type':'text/html'});return a;}});d._RepositoriesList=d._Base.extend({_prepareItem:function(a){var c=new b.User(a.owner.login,a.owner);return new b.Repository(a.name,c,a);}});d.UserRepositories=d._RepositoriesList.extend({_service:function(){return this.parent._service()+"/repos";}});d.UserStarredRepositories=d._RepositoriesList.extend({_service:function(){return this.parent._service()+"/starred";}});d.RepositoryForks=d._RepositoriesList.extend({_prepareItem:function(a){var c=new b.User(a.owner.login,a.owner);return new b.Repository(a.name,c,a,this.parent);},_service:function(){return this.parent._service()+"/forks";}});d.Search=d._Base.extend({constructor:function(a){this.keyword=a||null;d.Search.__super__.constructor.call(this,null);},search:function(a,b,c){this.list=[];this.keyword=a;this.fetch(b,c);}});b.Repository.Search=d.Search.extend({_service:function(){return "legacy/repos/search/"+this.keyword;},_prepareItem:function(a){var c=new b.User(a.owner);delete a.owner;delete a.username;return new b.Repository(a.name,c,a);},_onFetchSuccess:function(a,b){this.fetched=true;this._setItems(b.data.repositories);if(a)a(null,this);}});b.User.Search=d.Search.extend({_service:function(){return "legacy/user/search/"+this.keyword;},_prepareItem:function(a){return new b.User(a.login,a);},getByLogin:function(a){return this.getBy('login',a);},_onFetchSuccess:function(a,b){this.fetched=true;this._setItems(b.data.users);if(a)a(null,this);}});}).call(this);